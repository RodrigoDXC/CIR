<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_script">
    <sys_script action="INSERT_OR_UPDATE">
        <abort_action>false</abort_action>
        <access>package_private</access>
        <action_delete>false</action_delete>
        <action_insert>false</action_insert>
        <action_query>false</action_query>
        <action_update>true</action_update>
        <active>true</active>
        <add_message>false</add_message>
        <advanced>true</advanced>
        <change_fields>false</change_fields>
        <client_callable>false</client_callable>
        <collection>x_fru_cir_protection_agent_report</collection>
        <condition/>
        <description/>
        <execute_function>false</execute_function>
        <filter_condition/>
        <is_rest>false</is_rest>
        <message/>
        <name>cir_check_assignment_status</name>
        <order>100</order>
        <priority>100</priority>
        <rest_method/>
        <rest_method_text/>
        <rest_service/>
        <rest_service_text/>
        <rest_variables/>
        <role_conditions/>
        <script><![CDATA[(function executeRule(current, previous /*null when async*/) {
	// triggers the 'wait for condition - All protection agent reports in progress? Set to confirmed' activity on the 'Protection Service Order assignment handler' workflow to check if all reports from the protection service order were accepted (and then change the PSO state to confirmed)
	if (current.service_order) {
		var gr = new GlideRecord(CIRConstants.Tables.PROTECTION_SERVICE_ORDER);
		gr.addQuery('sys_id',current.getValue('service_order'));
		gr.query();
		if (gr.next()) {
			new global.Workflow().broadcastEventToCurrentsContexts(gr, 'update', null);
		}
	}

})(current, previous);]]></script>
        <sys_class_name>sys_script</sys_class_name>
        <sys_created_by>Paulo.Gomes@fruitionpartners.pt</sys_created_by>
        <sys_created_on>2020-07-30 12:57:43</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_domain_path>/</sys_domain_path>
        <sys_id>7feaf4cadb12dc10d4a73533f3961914</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>cir_check_assignment_status</sys_name>
        <sys_overrides/>
        <sys_package display_value="Corporate Incident Response" source="x_fru_cir">265c101f13ab44100b8670a76144b0a2</sys_package>
        <sys_policy/>
        <sys_scope display_value="Corporate Incident Response">265c101f13ab44100b8670a76144b0a2</sys_scope>
        <sys_update_name>sys_script_7feaf4cadb12dc10d4a73533f3961914</sys_update_name>
        <sys_updated_by>Paulo.Gomes@fruitionpartners.pt</sys_updated_by>
        <sys_updated_on>2020-07-30 12:57:43</sys_updated_on>
        <template/>
        <when>after</when>
    </sys_script>
    <sys_translated_text action="delete_multiple" query="documentkey=7feaf4cadb12dc10d4a73533f3961914"/>
</record_update>
